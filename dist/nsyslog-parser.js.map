{"version":3,"sources":["nsyslog-parser.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","module","$","parser","NSyslog","parse","window","FRX","CEP_FIELDS","splitHeaders","text","arr","map","scape","fields","curr","split","forEach","ch","push","splitFields","msg","tokens","token","shift","indexOf","kv","val","unshift","headers","extension","Pri","CEF","RXS","DOPS","cef","pid","peek","item","undefined","trim","assign","entry","host","appName","messageid","structuredData","line","opts","pri","match","originalMessage","prival","parseInt","get","facilityval","facility","levelval","level","FACILITY","id","LEVEL","NaN","items","substring","endparse","prinmr","version","type","ts","Date","month","day","time","year","getYear","invalidate","message","join","endsWith","eitem","replace","invalid","chain","pop","sdata","idx","nokeys","lastKey","test","prop","header","err","label","FACILITY_MAP","LEVEL_MAP","l","LEVELS","FACILITIES","val1","val2"],"mappings":"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","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n\"use strict\";\n\n(function($) {\n\tvar parser = require(\"./parser.js\");\n\t$.NSyslog = $.NSyslog || {};\n\t$.NSyslog.parse = parser;\n})(window);\n\n},{\"./parser.js\":3}],2:[function(require,module,exports){\nconst FRX = /[a-zA-Z][a-zA-Z0-9]+=/;\nconst CEP_FIELDS = [\n\t\"version\",\n\t\"deviceVendor\",\n\t\"deviceProduct\",\n\t\"deviceVersion\",\n\t\"deviceEventClassID\",\n\t\"name\",\n\t\"severity\",\n\t\"extension\"\n]\n\nfunction splitHeaders(text) {\n\tvar arr = [], map = {};\n\tvar scape = false;\n\tvar fields = 7;\n\tvar curr = \"\";\n\n\ttext.split(\"\").forEach(ch=>{\n\t\tif(!fields) {\n\t\t\tcurr += ch;\n\t\t}\n\t\telse {\n\t\t\tif(ch==\"|\") {\n\t\t\t\tif(scape) {\n\t\t\t\t\tscape = false;\n\t\t\t\t\tcurr += ch;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tarr.push(curr);\n\t\t\t\t\tcurr = \"\";\n\t\t\t\t\tfields--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(ch==\"\\\\\") {\n\t\t\t\tcurr += ch;\n\t\t\t\tscape = !scape;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tscape = false;\n\t\t\t\tcurr += ch;\n\t\t\t}\n\t\t}\n\t});\n\n\tif(curr.length)\n\t\tarr.push(curr);\n\n\tCEP_FIELDS.forEach((f,i)=>map[f]=arr[i]);\n\treturn map;\n}\n\nfunction splitFields(msg) {\n\tlet tokens = msg.split(\" \");\n\tlet map = {};\n\n\tlet token = null;\n\twhile(tokens.length) {\n\t\tif(!token) {\n\t\t\ttoken = tokens.shift();\n\t\t\tif(token.indexOf('=')>=0) {\n\t\t\t\tlet kv = token.split(\"=\");\n\t\t\t\ttoken = kv[0];\n\t\t\t\tmap[token] = kv[1];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmap[token] = \"\";\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tlet val = tokens.shift();\n\t\t\tif(val.indexOf('=')<0) {\n\t\t\t\tmap[token] += ` ${val}`;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttoken = null;\n\t\t\t\ttokens.unshift(val);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn map;\n}\n\nmodule.exports = {\n\tparse(text) {\n\t\tvar headers = splitHeaders(text);\n\t\tvar fields = splitFields(headers.extension || \"\");\n\t\treturn {\n\t\t\theaders : headers,\n\t\t\tfields : fields\n\t\t}\n\t}\n}\n\n},{}],3:[function(require,module,exports){\nconst\n\tPri = require(\"./pri.js\"),\n\tCEF = require(\"./cef.js\");\n\nconst RXS = {\n\t\"pri\" : /^<\\d+>/,\n\t\"prinmr\" : /^\\d+ /,\n\t\"prival\" : /<(\\d+)>/,\n\t\"month\" : /^[A-Za-z][a-z]{2} /,\n\t\"day\" : /^\\d{1,2} /,\n\t\"time\" : /^\\d+:\\d+:\\d+ /,\n\t\"ts\" : /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\S+ /,\n\t\"invalid\" : /[^a-zA-Z0-9\\.\\$\\-_#%\\/\\[\\]\\(\\)]/,\n\t\"sdata\" : /\\[(\\S+)( [^\\=]+\\=\\\"[^\\\"]+\\\")+\\]/g,\n\t\"cef\" : /^CEF:\\d+/\n}\n\nconst DOPS = {\n\tcef : true,\n\tfields : true,\n\tpid : true\n}\n\nfunction peek(arr) {\n\tdo {\n\t\tvar item = arr.shift();\n\t\tif(item===undefined) return item;\n\t\telse item = item.trim();\n\t}while(!item);\n\n\treturn item;\n}\n\nfunction assign(entry,item) {\n\tif(!entry.host) entry.host = item.trim();\n\telse if(!entry.appName) entry.appName = item.trim();\n\telse if(!entry.pid) entry.pid = item.trim();\n\telse if(!entry.messageid) entry.messageid = item.trim();\n\telse if(!entry.structuredData) {\n\t\tentry.structuredData = item.trim();\n\t\treturn false;\n\t}\n\telse return true;\n}\n\nfunction parse(line,opts) {\n\topts = opts || DOPS;\n\n\tvar pri = line.match(RXS.pri);\n\tvar entry = {\n\t\toriginalMessage : line\n\t};\n\n\t// First priority\n\tif(pri) {\n\t\tentry.pri = pri[0];\n\t\tentry.prival = parseInt(entry.pri.match(RXS.prival)[1]);\n\t\tvar prival = Pri.get(entry.prival);\n\t\tentry.facilityval = prival.facility;\n\t\tentry.levelval = prival.level;\n\t\tentry.facility = Pri.FACILITY[prival.facility].id;\n\t\tentry.level = Pri.LEVEL[prival.level].id;\n\t}\n\telse {\n\t\tentry.pri = \"\";\n\t\tentry.prival = NaN;\n\t}\n\n\t//Split message\n\tvar items = line.substring(entry.pri.length).split(\" \");\n\n\t// Date search\n\tvar endparse = false;\n\twhile(line.length && !endparse) {\n\t\tvar item = peek(items)+\" \";\n\n\t\t// RFC RFC5424\n\t\tif(item.match(RXS.prinmr)) {\n\t\t\tentry.version = parseInt(item);\n\t\t\tentry.type = \"RFC5424\";\n\t\t\titem = peek(items)+\" \";\n\t\t\tif(item.match(RXS.ts)) {\n\t\t\t\tentry.ts = new Date(Date.parse(item.match(RXS.ts)[0].trim()));\n\t\t\t}\n\t\t}\n\t\t// BSD\n\t\telse if(item.match(RXS.month)) {\n\t\t\tentry.type = \"BSD\";\n\t\t\tvar month = item.trim();\n\t\t\tvar day = peek(items);\n\t\t\tvar time = peek(items);\n\t\t\tvar year = new Date().getYear() + 1900\n\t\t\tentry.ts = new Date(Date.parse(year+\" \"+month+\" \"+day+\" \"+time));\n\t\t}\n\t\telse {\n\t\t\tentry.type = \"UNKNOWN\";\n\t\t\titems.unshift(item.trim());\n\t\t}\n\t\tendparse = true;\n\t}\n\n\t// No timestamp\n\tif(!entry.ts) entry.ts = new Date();\n\n\t// Is a standard syslog message\n\tif(entry.type) {\n\t\tendparse = false;\n\n\t\tfunction invalidate(item) {\n\t\t\titems.unshift(item);\n\t\t\tentry.message = items.join(\" \");\n\t\t\tendparse = true;\n\t\t}\n\n\t\twhile(line.length && !endparse) {\n\t\t\tvar item = peek(items);\n\t\t\tif(!item) {\n\t\t\t\tendparse = true;\n\t\t\t}\n\t\t\telse if(item.endsWith(\":\")){\n\t\t\t\tlet eitem = item.replace(/:$/,\"\").trim();\n\t\t\t\tif(eitem.match(RXS.invalid)) {\n\t\t\t\t\tinvalidate(item);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tassign(entry,eitem)\n\t\t\t\t\tentry.message = items.join(\" \");\n\t\t\t\t\tendparse = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(!items.length) {\n\t\t\t\tinvalidate(item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Invalid item (malformed message)\n\t\t\t\tif(item.match(RXS.invalid)) {\n\t\t\t\t\tinvalidate(item);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar r = assign(entry,item.replace(/: $/,\"\").trim())\n\t\t\t\t\tif(r===true) {\n\t\t\t\t\t\titems.unshift(item);\n\t\t\t\t\t\tentry.message = items.join(\" \");\n\t\t\t\t\t\tendparse = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if(r===false) {\n\t\t\t\t\t\tentry.message = items.join(\" \");\n\t\t\t\t\t\tendparse = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tentry.message = items.join(\" \");\n\t}\n\n\t// Chained hostnames\n\tentry.chain = (entry.host||\"\").split(\"/\");\n\tentry.host = entry.chain.pop();\n\n\t// Structured data\n\tif(entry.type==\"RFC5424\") {\n\t\tvar sdata = entry.message.match(RXS.sdata) || [];\n\t\tvar idx=0;\n\t\tentry.structuredData = sdata.map(item=>{\n\t\t\tvar map = {}, nokeys = [];\n\t\t\tvar lastKey = null;\n\t\t\tidx = entry.message.indexOf(item)+item.length+1;\n\t\t\titem.replace(/(^\\[)|(\\]$)/g,\"\").split(\" \").forEach((t,i)=>{\n\t\t\t\t// Extra space\n\t\t\t\tif(!t.trim()) return;\n\t\t\t\t// First element (ID of data)\n\t\t\t\tif(i==0) {\n\t\t\t\t\tmap[\"$id\"] = t;\n\t\t\t\t}\n\t\t\t\t// Key/Pair values\n\t\t\t\telse {\n\t\t\t\t\tvar kv = t.split(\"=\");\n\t\t\t\t\t// Correct key/value pair\n\t\t\t\t\tif(kv[0] && kv[1] && kv[1]!='\"') {\n\t\t\t\t\t\tlastKey = kv.shift();\n\t\t\t\t\t\tmap[lastKey] = kv.join(\"=\").replace(/\\\"/g,\"\");\n\t\t\t\t\t}\n\t\t\t\t\t// Last key had values separated by spaces\n\t\t\t\t\telse if(kv[0] && kv[1]===undefined){\n\t\t\t\t\t\tmap[lastKey] += \" \"+(kv[0]||\"\").replace(/\\\"/g,\"\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(kv[0] && (!kv[1].length || kv[1]=='\"')){\n\t\t\t\t\t\tmap[lastKey] += \" \"+(kv[0]||\"\").replace(/\\\"/g,\"\")+\"=\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn map;\n\t\t});\n\t\tentry.message = entry.message.substring(idx);\n\t}\n\n\t// CEF Event message\n\tif(opts.cef!==false && RXS.cef.test(entry.message)) {\n\t\tentry.type = \"CEF\";\n\t\tlet cef = CEF.parse(entry.message);\n\t\tentry.cef = cef.headers;\n\t\tentry.fields = cef.fields;\n\t}\n\t// Default syslog message\n\telse if(opts.fields!==false && entry.type!=\"UNKNOWN\"){\n\t\t// Message with fields\n\t\tvar fields = [];\n\t\tentry.message.split(\",\").forEach(kv=>{\n\t\t\tvar prop = kv.split(\"=\");\n\t\t\tif(prop.length==2)\n\t\t\t\tfields[prop[0]] = prop[1];\n\t\t});\n\t\tentry.fields = fields;\n\t}\n\n\t// header\n\tentry.header = line.substring(0,line.length-entry.message.length);\n\n\t// PID\n\tif(opts.pid && entry.appName && entry.appName.endsWith(\"]\")) {\n\t\tlet idx = entry.appName.indexOf(\"[\");\n\t\tif(idx>=0) {\n\t\t\tentry.pid = entry.appName.substring(idx+1,entry.appName.length-1);\n\t\t\tentry.appName = entry.appName.substring(0,idx);\n\t\t}\n\t}\n\n\treturn entry;\n}\n\nmodule.exports = function(line,opts) {try {return parse(line,opts)}catch(err){return {err:err}}};\n\n},{\"./cef.js\":2,\"./pri.js\":4}],4:[function(require,module,exports){\nconst FACILITY = [\n\t{id:\"kern\", label:\"kernel messages\"},\n\t{id:\"user\", label:\"user-level messages\"},\n\t{id:\"mail\", label:\"mail system\"},\n\t{id:\"daemon\", label:\"system daemons\"},\n\t{id:\"auth\", label:\"security/authorization messages\"},\n\t{id:\"syslog\", label:\"messages generated internally by syslogd\"},\n\t{id:\"lpr\", label:\"line printer subsystem\"},\n\t{id:\"news\", label:\"network news subsystem\"},\n\t{id:\"uucp\", label:\"UUCP subsystem\"},\n\t{id:\"cron\", label:\"clock daemon\"},\n\t{id:\"authpriv\", label:\"security/authorization messages\"},\n\t{id:\"ftp\", label:\"FTP daemon\"},\n\t{id:\"ntp\", label:\"NTP subsystem\"},\n\t{id:\"security\", label:\"log audit\"},\n\t{id:\"console\", label:\"log alert\"},\n\t{id:\"solaris-cron\", label:\"clock daemon\"},\n\t{id:\"local0\", label:\"locally used facility 0\"},\n\t{id:\"local1\", label:\"locally used facility 0\"},\n\t{id:\"local2\", label:\"locally used facility 0\"},\n\t{id:\"local3\", label:\"locally used facility 0\"},\n\t{id:\"local4\", label:\"locally used facility 0\"},\n\t{id:\"local5\", label:\"locally used facility 0\"},\n\t{id:\"local6\", label:\"locally used facility 0\"},\n\t{id:\"local7\", label:\"locally used facility 0\"}\n];\n\nconst LEVEL = [\n\t{id:\"emerg\", label:\"system is unusable\"},\n\t{id:\"alert\", label:\"action must be taken immediately\"},\n\t{id:\"crit\", label:\"critical conditions\"},\n\t{id:\"error\", label:\"error conditions\"},\n\t{id:\"warn\", label:\"warning conditions\"},\n\t{id:\"notice\", label:\"normal but significant condition\"},\n\t{id:\"info\", label:\"informational messages\"},\n\t{id:\"debug\", label:\"debug-level messages\"}\n]\n\nvar FACILITY_MAP = [];\nvar LEVEL_MAP = [];\n\nFACILITY.forEach((f,i)=>FACILITY_MAP[f.id]=i);\nLEVEL.forEach((l,i)=>LEVEL_MAP[l.id]=i);\n\nmodule.exports.LEVEL = LEVEL;\nmodule.exports.FACILITY = FACILITY;\nmodule.exports.LEVELS = LEVEL_MAP;\nmodule.exports.FACILITIES = FACILITY_MAP;\nmodule.exports.get = function(val1,val2) {\n\tif(typeof(val1)==\"number\" && typeof(val2)==\"undefined\") {\n\t\treturn {\n\t\t\tlevel : val1 & 0x7,\n\t\t\tfacility : val1 >> 3\n\t\t}\n\t}\n\telse if(typeof(val1)==\"number\" && typeof(val2)==\"number\") {\n\t\treturn val1*8 + val2;\n\t}\n\telse if(typeof(val1)==\"string\" && typeof(val2)==\"number\") {\n\t\treturn (FACILITY_MAP[val1]||0)*8 + val2;\n\t}\n\telse if(typeof(val1)==\"number\" && typeof(val2)==\"string\") {\n\t\treturn val1*8 + (LEVEL_MAP[val2]||0);\n\t}\n\telse if(typeof(val1)==\"string\" && typeof(val2)==\"string\") {\n\t\treturn (FACILITY_MAP[val1]||0)*8 + (LEVEL_MAP[val2]||0);\n\t}\n\telse {\n\t\treturn {level:0, facility:0}\n\t}\n}\n\n},{}]},{},[1]);\n"],"file":"nsyslog-parser.js"}